<!--
 * @Descripttion: 
 * @Author: xiangjun02
 * @Date: 2022-03-08 11:42:03
 * @LastEditors: xiangjun02
 * @LastEditTime: 2022-03-08 12:06:10
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>渲染器-代码实现TODO</title>
    
</head>
<body>
</body>
</html>
<script>
    // 定义虚拟DOM
    const vnode = {
        tag: 'div',
        props:  {
            onClick: ()=>{
                alert('渲染器demo')
            }
        },
        children: 'click me'
    }
    // 新构建虚拟dom测试
    // const vnode = {
    //     tag: 'div',
    //     props:  {
    //         onClick: ()=>{
    //             alert('渲染器demo')
    //         }
    //     },
    //     children: [{
    //         tag: 'div',
    //         props: {
    //             onClick: ()=>{
    //                 alert('我是大向')
    //             }
    //         },
    //         children: '大向',
    //     }]
    // }

    // 编写渲染器：把虚拟DOM渲染为真实DOM
    function renderer(vnode, container){
        // 使用vnode.tag 作为标签名称创建DOM元素
        const el = document.createElement(vnode.tag)

        // 遍历vnode.props，将属性和事件添加到DOM元素
        for(key in vnode.props) {
            if(/^on/.test(key)) {
                // 如果是以on开头，则说明它是事件
                el.addEventListener(
                    key.substring(2).toLowerCase(), // 事件名称onClick => click
                    vnode.props[key], // 事件处理函数
                    false
                ) 
            }
        }

        // 处理children
        if(typeof vnode.children === 'string') {
            // 如果children 是字符串，说明它是元素的文本子节点
            el.appendChild(document.createTextNode(vnode.children))
        } else if (Array.isArray(vnode.children)){
            // 如果children 是数组，则递归调用renderer渲染子节点，使用当前的元素作为挂载点
            vnode.children.forEach(child => renderer(child, el))
        }

        // 将元素添加到挂载点下
        container.appendChild(el)
    }
    // 测试，挂载到document.body下
    renderer(vnode, document.body)
</script>